test_name: Add an article with a new tag

stages:
  - name: Create an article
    request:
      url: http://localhost:5001/articles/create
      auth:
        - testuser
        - testpassword
      json:
        title: Student's name deletes entire database
        content: Lorem ipsum dolor sit amet
      method: POST
      headers:
        content-type: application/json
    response:
      status_code: 200
      headers:
        content-type: application/json
      body:
        article_id: /articles/1

  - name: Add a tag to that article
    request:
      url: http://localhost:5002/tags/databases
      auth:
        - testuser
        - testpassword
      json:
        article_id: /articles/1
      method: POST
      headers:
        content-type: application/json
    response:
      status_code: 200
      headers:
        content-type: application/json
      body:
        article_id: /articles/1
        tags:
          - databases

  - name: List articles with databases tag
    request:
      url: http://localhost:5002/tags/databases
      method: GET
      headers:
        content-type: application/json
    response:
      status_code: 200
      headers:
        content-type: application/json
      body:
        count: 1
        articles:
          - /articles/1

  - name: Add another tag to the article
    request:
      url: http://localhost:5002/tags/sql
      auth:
        - testuser
        - testpassword
      json:
        article_id: /articles/1
      method: POST
      headers:
        content-type: application/json
    response:
      status_code: 200
      headers:
        content-type: application/json
      body:
        article_id: /articles/1
        tags:
          - databases
          - sql

  - name: Delete a tag from an article
    request:
      url: http://localhost:5002/tags/sql
      auth:
        - testuser
        - testpassword
      json:
        article_id: /articles/1
      method: DELETE
      headers:
        content-type: application/json
    response:
      status_code: 200
      headers:
        content-type: application/json
      body:
        article_id: /articles/1
        tags:
          - databases
